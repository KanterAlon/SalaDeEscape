@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

//los id de esta página sirven para cosas del js sobre el temporizador, y no tienen nada que ver con css o estilos 

<body class="Landing">
    <div class="content-container">
        <h1>Namalteufa</h1>
        <form method="post" action="@Url.Action("Comenzar", "Home")">
            <input type="text" name="jugador" placeholder="Ingresa tu nombre" required autocomplete="off">
            <label for="nivel">Selecciona el nivel:</label>
            <select name="nivel" id="nivel" required>
                <option value="1">Fácil (15 minutos)</option>
                <option value="2">Medio (10 minutos)</option>
                <option value="3">Difícil (5 minutos)</option>
            </select>
            <button type="submit" class="btn btn-primary-custom">Comenzar</button>
        </form>
        <a class="btn btn-secondary-custom" href="@Url.Action("Tutorial", "Home")">Tutorial</a>
        <a class="btn btn-default-custom" href="@Url.Action("Creditos", "Home")">Creditos</a>
        <div class="button-container">
            <button id="generate-airplane" class="btn btn-default-custom" style="margin-top: 40px;">Generar Avión</button>
            <button id="generate-juli" class="btn btn-default-custom" style="margin-top: 40px;">Generar Juli Medina</button>
        </div>
        <img id="dingdong-bell" src="/img/bell.png" alt="Ding Dong Bell" style="cursor: pointer; width: 50px; height: 50px; margin-top: 20px;">
    </div>

    <!-- Contenedor para los aviones generados -->
    <div id="airplane-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const airplaneContainer = document.getElementById('airplane-container');
            const generateAirplaneButton = document.getElementById('generate-airplane');
            const generateJuliButton = document.getElementById('generate-juli');
            const dingdongBell = document.getElementById('dingdong-bell');
            const dingdongAudio = new Audio('/img/dingdong.mp3');
            let item = null;
            let itemInterval = null;

            generateAirplaneButton.addEventListener('click', () => {
                if (item) {
                    item.remove();
                    clearInterval(itemInterval);
                }
                createItem('airplane', '/img/airplane.png');
            });

            generateJuliButton.addEventListener('click', () => {
                if (item) {
                    item.remove();
                    clearInterval(itemInterval);
                }
                createItem('juli', '/img/julimedina.png');
            });

            dingdongBell.addEventListener('click', () => {
                dingdongAudio.play();
            });

            function createItem(type, imageUrl) {
                item = document.createElement('div');
                item.classList.add(type);
                item.style.backgroundImage = `url('${imageUrl}')`;

                const startX = Math.random() * window.innerWidth;
                item.style.left = `${startX}px`;
                item.style.top = `-100px`; // Start above the screen

                airplaneContainer.appendChild(item);

                item.addEventListener('click', () => {
                    itemClickHandler(item);
                });

                moveItem(item);
            }

            function moveItem(item) {
                let posX = parseFloat(item.style.left);
                let posY = parseFloat(item.style.top);
                let velX = (Math.random() - 0.5) * 4;
                let velY = (Math.random() - 0.5) * 10;
                const gravity = 0.5;
                const bounce = 0.7;
                const groundLevel = window.innerHeight - 30; // Ajustar el valor del rebote en el borde inferior

                itemInterval = setInterval(() => {
                    posX += velX;
                    posY += velY;
                    velY += gravity;

                    if (posX + item.clientWidth > window.innerWidth || posX < 0) {
                        velX *= -bounce;
                        posX = Math.max(0, Math.min(window.innerWidth - item.clientWidth, posX));
                    }
                    if (posY + item.clientHeight > groundLevel) {
                        velY *= -bounce;
                        posY = groundLevel - item.clientHeight;
                        if (Math.abs(velY) < 1) {
                            velY = 0;
                            velX = 0;
                            clearInterval(itemInterval);
                        }
                    }

                    item.style.left = `${posX}px`;
                    item.style.top = `${posY}px`;
                }, 20);
            }

            function itemClickHandler(item) {
                clearInterval(itemInterval); // Stop current movement
                let velX = (Math.random() - 0.5) * 4;
                let velY = -(Math.random() * 15 + 10); // Stronger upward force
                let posX = parseFloat(item.style.left);
                let posY = parseFloat(item.style.top);
                const gravity = 0.5;
                const bounce = 0.7;
                const groundLevel = window.innerHeight - 30; // Ajustar el valor del rebote en el borde inferior

                itemInterval = setInterval(() => {
                    if (!item) {
                        clearInterval(itemInterval);
                        return;
                    }

                    posX += velX;
                    posY += velY;
                    velY += gravity;

                    if (posX + item.clientWidth > window.innerWidth || posX < 0) {
                        velX *= -bounce;
                        posX = Math.max(0, Math.min(window.innerWidth - item.clientWidth, posX));
                    }
                    if (posY + item.clientHeight > groundLevel) {
                        velY *= -bounce;
                        posY = groundLevel - item.clientHeight;
                        if (Math.abs(velY) < 1) {
                            velY = 0;
                            velX = 0;
                            clearInterval(itemInterval);
                        }
                    }

                    item.style.left = `${posX}px`;
                    item.style.top = `${posY}px`;
                }, 20);
            }
        });
    </script>
</body>
